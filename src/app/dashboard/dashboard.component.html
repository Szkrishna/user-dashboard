<div class="main">
    <div class="container mb-4">
        <div class="leftbar">
            <span class="img-icon mb-2">
                <img src="assets/icon.png" alt="Icon" width="16" height="16" />
            </span>
            <span class="mb-2">
                <lucide-icon class="icon" [img]="House"></lucide-icon>
            </span>
            <span class="mb-2">
                <lucide-icon class="icon" [img]="ChartColumnIncreasing"></lucide-icon>
            </span>
            <span class="mb-2">
                <lucide-icon class="icon" [img]="Layers"></lucide-icon>
            </span>
            <span class="mb-2">
                <lucide-icon class="icon" [img]="CopyCheck"></lucide-icon>
            </span>
            <span class="mb-2">
                <lucide-icon class="icon" [img]="ChartPie"></lucide-icon>
            </span>
            <span class="mb-2">
                <lucide-icon class="icon" [img]="Users"></lucide-icon>
            </span>
        </div>

        <div class="rightbar">
            <div class="topbar">
                <div class="raw">
                    <div class="welcome">
                        <h1 class="mt-5">Welcome back, Olivia</h1>
                    </div>

                    <div class="dashboard-toolbar">
                        <div class="cursor-pointer">
                            <lucide-icon class="icon search-icon" [img]="Search"></lucide-icon>
                        </div>

                        <button class="btn"><lucide-icon class="icon btn-icon" [img]="Settings2"></lucide-icon>Customize
                        </button>

                        <button class="btn"><lucide-icon class="icon btn-icon"
                                [img]="CloudDownload"></lucide-icon>Export
                        </button>
                    </div>
                </div>
            </div>

            <div class="graphs">
                <div class="raw">
                    <div class="breakdown">
                        <div class="custom-card">
                            <div class="custom-card-header">
                                <div class="raw">
                                    <div class="chart-title">
                                        <div class="box mr-2">
                                            <lucide-icon class="box-icon" [img]="Box"></lucide-icon>
                                        </div>
                                        <div>
                                            <h3 class="mb-1">Vendor breakdown</h3>
                                            <p class="mb-0">Keep track of vendors and their security ratings.</p>
                                        </div>
                                    </div>

                                    <div class="align-top">
                                        <lucide-icon class="icon ellipse" [img]="EllipsisVertical"></lucide-icon>
                                    </div>
                                </div>
                            </div>

                            <div class="custom-card-body pb-2 pt-2">
                                <div id="column-container" class="bar-container"></div>

                                <!-- <div id="barChart">
                                    <apx-chart *ngIf="barChartOptions" [id]="'barChart'" [series]="barChartOptions.series"
                                        [chart]="barChartOptions.chart" [xaxis]="barChartOptions.xaxis"
                                        [yaxis]="barChartOptions.yaxis" [plotOptions]="barChartOptions.plotOptions"
                                        [dataLabels]="barChartOptions.dataLabels" [colors]="barChartOptions.colors"
                                        [title]="barChartOptions.title">
                                    </apx-chart>
                                </div> -->
                            </div>

                            <div class="custom-card-footer text-end">
                                <button class="btn">View full report</button>
                            </div>
                        </div>
                    </div>

                    <div class="monitored">
                        <div class="custom-card">
                            <div class="custom-card-header">
                                <div class="raw">
                                    <div class="chart-title">
                                        <div>
                                            <h3 class="mb-1">Vendors monitored</h3>
                                            <p class="mb-0">You're using 80% of available spots.</p>
                                        </div>
                                    </div>

                                    <div class="align-top">
                                        <lucide-icon class="icon ellipse" [img]="EllipsisVertical"></lucide-icon>
                                    </div>
                                </div>
                            </div>

                            <div class="custom-card-body radial-custom-card-body p-0 ">
                                <div class="radial-custom-card">
                                    <div class="radial-container">
                                        <apx-chart *ngIf="radialChartOptions" [series]="radialChartOptions.series!"
                                            [chart]="radialChartOptions.chart!"
                                            [plotOptions]="radialChartOptions.plotOptions!"
                                            [fill]="radialChartOptions.fill!" [stroke]="radialChartOptions.stroke!"
                                            [labels]="radialChartOptions.labels!">
                                        </apx-chart>
                                    </div>

                                    <div class="trending p-4 pl-0 flex items-center space-x-2">
                                        <span>
                                            <lucide-icon class="trending-icon" [img]="TrendingUp"></lucide-icon>
                                        </span>
                                        <p class="mt-3 mb-0 text-[#65a583] font-semibold text-lg">10%</p>
                                    </div>
                                </div>

                                <div class="pl-6 ml-4 mb-4 radial-below-text">
                                    <h5>
                                        You've almost reached your limit
                                    </h5>

                                    <p>
                                        You have used 80% of your available spots.<br />
                                        Upgrade plan to monitor more vendors.
                                    </p>
                                </div>
                            </div>

                            <div class="custom-card-footer text-end">
                                <button class="btn">
                                    <lucide-icon class="icon btn-icon" [img]="Zap"></lucide-icon>
                                    Upgrade plan
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="leftbar table-nav">
            <span class="mb-2">
                <lucide-icon class="icon" [img]="Cog"></lucide-icon>
            </span>

            <span class="mb-2">
                <lucide-icon class="icon" [img]="Settings"></lucide-icon>
            </span>

            <span class="user">
                <!-- <img class="user-icon" src="assets/profile-user.png" alt="user"> -->
                <div>
                    <div class="initials-circle">
                        {{ gridData[0][gridColumns[0].column_key]?.first_name.charAt(0) }}
                        {{ gridData[0][gridColumns[0].column_key]?.last_name.charAt(0) }}
                    </div>
                </div>

                <span class="box2">
                    <lucide-icon class="box-icon2" [img]="Box"></lucide-icon>
                </span>
            </span>
        </div>

        <div class="rightbar">
            <div class="custom-card table-custom-card">
                <div class="custom-card-header">
                    <div class="raw">
                        <div class="chart-title">
                            <div class="table-left">
                                <h3 class="mb-1 mt-3">Team members</h3>
                                <p class="table-badge">100 users</p>
                            </div>
                        </div>

                        <div class="align-top">
                            <lucide-icon class="icon ellipse" [img]="EllipsisVertical"></lucide-icon>
                        </div>
                    </div>
                </div>

                <div class="custom-card-body p-0">
                    <div class="table-responsive">
                        <table class="mb-0 custom-table">
                            <thead class="table-light">
                                <tr>
                                    <th scope="col" class="pr-0">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="selectAll"
                                                [(ngModel)]="isAllSelected" (change)="toggleSelectAll()" />
                                            <label class="form-check-label" for="selectAll"></label>
                                        </div>
                                    </th>

                                    <th scope="col" *ngFor="let col of gridColumns">
                                        <ng-container [ngSwitch]="col.column_name">
                                            <span *ngSwitchCase="'Status'">
                                                {{ col.column_name }}
                                                <lucide-icon class="icon table-header-icon"
                                                    [img]="ArrowDown"></lucide-icon>
                                            </span>

                                            <span *ngSwitchCase="'Role'">
                                                {{ col.column_name }}
                                                <lucide-icon class="icon table-header-icon"
                                                    [img]="CircleQuestionMark"></lucide-icon>
                                            </span>

                                            <span class="license" *ngSwitchCase="'License Use'">
                                                {{ col.column_name }}
                                            </span>

                                            <span *ngSwitchDefault>
                                                {{ col.column_name }}
                                            </span>
                                        </ng-container>
                                    </th>

                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of gridData">
                                    <td class="pr-0">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox"
                                                [checked]="selectedRows.has(row.id)"
                                                (change)="toggleRowSelection(row.id)" [id]="'rowCheck_' + row.id" />
                                            <label class="form-check-label" [for]="'rowCheck_' + row.id"></label>
                                        </div>
                                    </td>

                                    <td *ngFor="let col of gridColumns">
                                        <ng-container [ngSwitch]="col.type">
                                            <span *ngSwitchCase="'name'" class="d-flex align-items-center name-cell">
                                                <div class="initials-circle me-2">
                                                    {{ row[col.column_key]?.first_name.charAt(0) }}{{
                                                    row[col.column_key]?.last_name.charAt(0) }}
                                                </div>

                                                <div class="name-details">
                                                    <div class="name-text">{{ row[col.column_key]?.first_name }} {{
                                                        row[col.column_key]?.last_name }}</div>
                                                    <div class="handle-text">{{ row[col.column_key]?.handle }}</div>
                                                </div>
                                            </span>

                                            <span *ngSwitchCase="'status'" class="badge status-badge"
                                                [ngClass]="getStatusClass(row[col.column_key])">
                                                <span class="status-dot"></span>
                                                {{ row[col.column_key] }}
                                            </span>

                                            <span *ngSwitchCase="'text'">
                                                {{ row[col.column_key] }}
                                            </span>

                                            <span *ngSwitchCase="'progress'" class="progress-wrapper">
                                                <div class="progress-bar-container">
                                                    <div class="progress-bar-fill"
                                                        [style.width.%]="row[col.column_key]"></div>
                                                </div>
                                                <span class="progress-percent">{{ row[col.column_key] }}%</span>
                                            </span>

                                            <span *ngSwitchCase="'tags'">
                                                <ng-container *ngFor="let tag of row[col.column_key]">
                                                    <span class="badge me-1" [ngClass]="getTagClass(tag)">
                                                        {{ tag.value }}
                                                    </span>
                                                </ng-container>
                                            </span>
                                        </ng-container>
                                    </td>

                                    <td>
                                        <lucide-icon class="icon mr-2 cursor-pointer" [img]="Trash2"
                                            (click)="openDeleteModal(row)" data-bs-toggle="modal"
                                            data-bs-target="#confirmDeleteModal">
                                        </lucide-icon>

                                        <lucide-icon class="icon cursor-pointer" [img]="Pencil"
                                            (click)="openEditModal(row)" data-bs-toggle="modal"
                                            data-bs-target="#confirmEditModal">
                                        </lucide-icon>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>


                <div class="custom-card-footer pt-4 pb-4">
                    <div class="pagination-wrapper">
                        <div class="footer-left">
                            <button class="btn">
                                <lucide-icon class="icon btn-icon" [img]="ArrowLeft"></lucide-icon>
                                Previous
                            </button>
                        </div>

                        <div class="footer-middle">
                            <span class="page active">1</span>
                            <span class="page">2</span>
                            <span class="page">3</span>
                            <span class="dots">....</span>
                            <span class="page">8</span>
                            <span class="page">9</span>
                            <span class="page">10</span>
                        </div>

                        <div class="footer-right">
                            <button class="btn">
                                Next
                                <lucide-icon class="icon btn-icon" [img]="ArrowRight"></lucide-icon>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- delete confirmation modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-soft-danger">
                <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
            </div>

            <div class="modal-body text-center p-6">
                <div class="mb-3 lottie-wrapper">
                    <lottie-player src="assets/delete-lottie.json" background="transparent" speed="1"
                        class="lottie-class" loop autoplay>
                    </lottie-player>
                </div>

                Are you sure you want to delete <strong>{{ selectedUser?.name?.first_name }} {{
                    selectedUser?.name?.last_name }}</strong>?
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="closeModal()">Cancel</button>
                <button type="button" class="btn btn-danger" (click)="confirmDelete()">Yes, Delete</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit confirmation modal -->
<div class="modal fade" id="confirmEditModal" tabindex="-1" aria-labelledby="confirmEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-soft-seconday">
                <h5 class="modal-title" id="confirmEditModalLabel">Confirm Edit</h5>
                <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
            </div>

            <div class="modal-body text-center p-6">
                <div class="mb-3 lottie-wrapper">
                    <lottie-player src="assets/edit-lottie.json" background="transparent" speed="1" class="lottie-class"
                        loop autoplay>
                    </lottie-player>
                </div>

                Are you sure you want to Edit <strong>{{ selectedUser?.name?.first_name }} {{
                    selectedUser?.name?.last_name }}</strong>?
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="closeModal()">Cancel</button>
                <button type="button" class="btn btn-success" (click)="confirmDelete()">Yes, Edit</button>
            </div>
        </div>
    </div>
</div>